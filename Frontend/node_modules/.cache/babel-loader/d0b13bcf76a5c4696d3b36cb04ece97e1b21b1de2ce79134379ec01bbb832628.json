{"ast":null,"code":"import _regeneratorRuntime from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{NavLink}from\"react-router-dom\";import authService from\"../../../Services/AuthService\";import notifyService from\"../../../Services/NotifyService\";import vacationsService from\"../../../Services/VacationsService\";import Spinner from\"../../SharedArea/Spinner/Spinner\";import VacationCard from\"../VacationCard/VacationCard\";import\"./VacationList.css\";import GraphSymbol from\"../../../Assets/Images/bar-graph.png\";import{vacationsStore}from\"../../../Redux/VacationsState\";import yoda from\"../../../Assets/Images/yoda.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var VacationList=function VacationList(props){var _useState=useState({currentPage:0,data:[],itemsPerPage:6,pageCount:0}),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),vacations=_useState4[0],setVacations=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loggedIn=_useState6[0],setLoggedIn=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),role=_useState8[0],setRole=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),checked=_useState10[0],setChecked=_useState10[1];useEffect(function(){vacationsService.getAllVacationsWithLikes().then(function(vacations){return setVacations(vacations);}).catch(function(err){return notifyService.error(err);});authService.isAdmin().then(function(role){return setRole(role);}).catch(function(err){return notifyService.error(err);});authService.getUserIdFromToken().then(function(logged){if(logged!=0)setLoggedIn(true);}).catch(function(err){return notifyService.error(err);});var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return vacationsService.getAllVacationsWithLikes();case 2:data=_context.sent;setState(_objectSpread(_objectSpread({},state),{},{data:data,pageCount:Math.ceil(data.length/state.itemsPerPage)}));case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();var unsubscribe=vacationsStore.subscribe(function(){setVacations(vacationsStore.getState().vacations);console.log(vacations);});return function(){return unsubscribe();};},[]);var handlePageClick=function handlePageClick(pageNumber){if(checked){var data=vacations.filter(function(v){return v.isFollowing;});setState(_objectSpread(_objectSpread({},state),{},{currentPage:pageNumber,data:data,pageCount:Math.ceil(data.length/state.itemsPerPage)}));}else{var _data=vacations;setState(_objectSpread(_objectSpread({},state),{},{currentPage:pageNumber,data:_data,pageCount:Math.ceil(_data.length/state.itemsPerPage)}));}};var pageData=state.data.slice(state.currentPage*state.itemsPerPage,(state.currentPage+1)*state.itemsPerPage);function showVacations(){return _showVacations.apply(this,arguments);}function _showVacations(){_showVacations=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var data,_data2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:try{if(!checked){setChecked(true);data=vacations.filter(function(v){return v.isFollowing;});setState(_objectSpread(_objectSpread({},state),{},{currentPage:0,data:data,pageCount:Math.ceil(data.length/state.itemsPerPage)}));}else{setChecked(false);_data2=vacations;setState(_objectSpread(_objectSpread({},state),{},{currentPage:0,data:_data2,pageCount:Math.ceil(_data2.length/state.itemsPerPage)}));}}catch(err){notifyService.error(err);}case 1:case\"end\":return _context2.stop();}}},_callee2);}));return _showVacations.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"VacationList\",children:[state.data.length===0&&!checked&&/*#__PURE__*/_jsx(Spinner,{}),state.data.length===0&&checked&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"noFollows\",children:[/*#__PURE__*/_jsx(\"img\",{src:yoda}),/*#__PURE__*/_jsx(\"span\",{className:\"Yoda\",children:\"Follow vacations, you do not Mmmmm?\"})]})}),role&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NavLink,{className:\"Add\",to:\"/vacations/new\",children:\"+\"}),/*#__PURE__*/_jsx(NavLink,{to:\"/Graph\",children:/*#__PURE__*/_jsx(\"img\",{src:GraphSymbol})})]}),!role&&loggedIn&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"filter\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"rocker rocker-small\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onChange:function onChange(){return showVacations();},checked:checked?true:false}),/*#__PURE__*/_jsx(\"span\",{className:\"switch-left\",children:\"\\u2714\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"switch-right\",children:\"All\"})]})})}),pageData.map(function(v){return/*#__PURE__*/_jsx(VacationCard,{vacation:v},v.vacationId);}),/*#__PURE__*/_jsxs(\"div\",{className:\"Pagination\",children:[Array.from({length:state.pageCount},function(_,i){return/*#__PURE__*/_jsx(\"button\",{className:\"Pagination-options\",onClick:function onClick(){return handlePageClick(i);},children:i+1},i);}),/*#__PURE__*/_jsxs(\"span\",{className:\"WhatPage\",children:[\"Page \",state.currentPage+1,\" out of \",state.pageCount]})]})]});};export default VacationList;","map":{"version":3,"names":["React","useEffect","useState","NavLink","authService","notifyService","vacationsService","Spinner","VacationCard","GraphSymbol","vacationsStore","yoda","VacationList","props","currentPage","data","itemsPerPage","pageCount","state","setState","vacations","setVacations","loggedIn","setLoggedIn","role","setRole","checked","setChecked","getAllVacationsWithLikes","then","catch","err","error","isAdmin","getUserIdFromToken","logged","fetchData","Math","ceil","length","unsubscribe","subscribe","getState","console","log","handlePageClick","pageNumber","filter","v","isFollowing","pageData","slice","showVacations","map","vacationId","Array","from","_","i"],"sources":["/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/src/Components/VacationsArea/VacationList/VacationList.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { NavLink } from \"react-router-dom\";\nimport VacationModel from \"../../../Models/VacationModel\";\nimport authService from \"../../../Services/AuthService\";\nimport notifyService from \"../../../Services/NotifyService\";\nimport vacationsService from \"../../../Services/VacationsService\";\nimport Spinner from \"../../SharedArea/Spinner/Spinner\";\nimport VacationCard from \"../VacationCard/VacationCard\";\nimport \"./VacationList.css\";\nimport GraphSymbol from \"../../../Assets/Images/bar-graph.png\"\nimport { vacationsStore } from \"../../../Redux/VacationsState\";\nimport yoda from \"../../../Assets/Images/yoda.png\"\n\n\ninterface IProps {}\ninterface IState {\n    currentPage: number;\n    data: any[];\n    itemsPerPage: number;\n    pageCount: number;\n}\n\nconst VacationList: React.FC<IProps> = (props: IProps) => {\n    const [state, setState] = useState<IState>({ \n        currentPage: 0, \n        data: [],\n        itemsPerPage: 6,\n        pageCount: 0\n    });\n\n\n    const [vacations, setVacations] = useState<VacationModel[]>([]);\n    const [loggedIn, setLoggedIn] = useState<boolean>(false);\n    const [role, setRole] = useState<boolean>();\n    const [checked, setChecked] = useState<boolean>(false);\n\n\n    useEffect(() => {\n        vacationsService.getAllVacationsWithLikes()\n            .then(vacations => setVacations(vacations))\n            .catch(err => notifyService.error(err))\n\n        authService.isAdmin()\n            .then(role => setRole(role))\n            .catch(err => notifyService.error(err));\n            \n        authService.getUserIdFromToken()\n            .then(logged => {if(logged!=0)setLoggedIn(true)})\n            .catch(err => notifyService.error(err));\n            \n            const fetchData = async () => {\n                const data = await vacationsService.getAllVacationsWithLikes();\n                setState({ ...state, data, pageCount: Math.ceil(data.length / state.itemsPerPage) });\n            }\n            fetchData();\n\n            const unsubscribe = vacationsStore.subscribe(() => {\n                setVacations(vacationsStore.getState().vacations);\n                console.log(vacations);\n                \n            });\n            \n            return () => unsubscribe();\n    \n\n    }, []);\n\n    const handlePageClick = (pageNumber: number) => {\n        if(checked) {\n            const data = vacations.filter(v => v.isFollowing);\n            setState({ ...state, currentPage: pageNumber, data, pageCount: Math.ceil(data.length / state.itemsPerPage) });\n        }\n        else{\n            const data = vacations;\n        setState({ ...state, currentPage: pageNumber, data, pageCount: Math.ceil(data.length / state.itemsPerPage) });\n        }\n    }\n\n    let pageData = state.data.slice(state.currentPage * state.itemsPerPage, (state.currentPage + 1) * state.itemsPerPage);\n    \n\n    async function showVacations() { \n        try {\n        if(!checked){\n            setChecked(true);\n             const data = vacations.filter(v => v.isFollowing);\n             setState({ ...state, currentPage: 0, data, pageCount: Math.ceil(data.length / state.itemsPerPage) });\n        }\n        else{\n            setChecked(false);\n            const data = vacations;\n            setState({ ...state, currentPage: 0, data, pageCount: Math.ceil(data.length / state.itemsPerPage) });\n        }\n        } catch (err: any) {\n            notifyService.error(err);\n        }\n    }\n\n    return (\n        <div className=\"VacationList\">\n\n            {state.data.length === 0 && !checked && <Spinner />}\n            {state.data.length === 0 && checked && <>\n            <div className=\"noFollows\">\n            <img src={yoda}></img>\n                <span className=\"Yoda\">Follow vacations, you do not Mmmmm?</span>\n            </div>\n            </>}\n            \n            {role && <>\n                <NavLink className={\"Add\"} to=\"/vacations/new\">+</NavLink>\n                <NavLink to=\"/Graph\"><img src={GraphSymbol} /></NavLink>\n            </>\n\n            \n            }\n\n            {!role && loggedIn && <>\n            <div className=\"filter\">\n                <label className=\"rocker rocker-small\">\n                    <input type=\"checkbox\" \n                    onChange={() => showVacations()}\n                    checked={checked? true : false}></input>\n                    <span className=\"switch-left\">✔️</span>\n                    <span className=\"switch-right\">All</span>\n                </label>\n            </div>\n            </>\n            }\n\n            {pageData.map(v => <VacationCard key={v.vacationId} vacation={v} />)}\n\n            <div className=\"Pagination\">\n                {Array.from({length: state.pageCount}, (_, i) => (\n                <button className=\"Pagination-options\" key={i} onClick={() => handlePageClick(i)}>\n                    {i+1}\n                </button>\n                ))}\n                <span className=\"WhatPage\">Page {state.currentPage+1} out of {state.pageCount}</span>\n            </div>\n            \n        </div>\n    );\n}\n\nexport default VacationList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}