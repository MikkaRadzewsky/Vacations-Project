{"ast":null,"code":"import _regeneratorRuntime from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useEffect}from\"react\";import{useForm}from\"react-hook-form\";import{useNavigate,useParams}from\"react-router-dom\";import VacationModel from\"../../../Models/VacationModel\";import{VacationsActionType,vacationsStore}from\"../../../Redux/VacationsState\";import authService from\"../../../Services/AuthService\";import notifyService from\"../../../Services/NotifyService\";import vacationsService from\"../../../Services/VacationsService\";import\"./EditVacation.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditVacation(){var _formState$errors$des,_formState$errors$des2,_formState$errors$sta,_formState$errors$end,_formState$errors$pri;var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,formState=_useForm.formState,setValue=_useForm.setValue;var navigate=useNavigate();var params=useParams();var currentDate=new Date().toISOString().split(\"T\")[0];useEffect(function(){if(!authService.isAdmin()){notifyService.error(\"You must be logged in as admin\");navigate(\"/vacations\");return;}var id=+params.vacationId;vacationsService.getOneVacation(id).then(function(vacation){console.log(vacation);setValue(\"vacationId\",vacation.vacationId);setValue(\"destination\",vacation.destination);setValue(\"description\",vacation.description);setValue(\"startDate\",new Date(vacation.startDate).toISOString().split('T')[0]);setValue(\"endDate\",new Date(vacation.endDate).toISOString().split('T')[0]);setValue(\"price\",vacation.price);}).catch(function(err){return notifyService.error(err);});},[]);function send(_x){return _send.apply(this,arguments);}function _send(){_send=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(vacation){var currentVacation;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(new Date(vacation.startDate)>new Date(vacation.endDate))){_context.next=4;break;}notifyService.error(\"Start date must be before the end date\");return _context.abrupt(\"return\");case 4:if(!(vacation.image.length<1)){_context.next=10;break;}_context.next=7;return vacationsService.getOneVacation(vacation.vacationId);case 7:currentVacation=_context.sent;console.log(currentVacation,\"works\");vacation.imageName=currentVacation.imageName;case 10:_context.next=12;return vacationsService.updateVacation(vacation);case 12:vacationsStore.dispatch({type:VacationsActionType.EmptyStore,payload:[]});notifyService.success(\"Vacation has been successfully updated\");navigate(\"/vacations\");_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](0);notifyService.error(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[0,17]]);}));return _send.apply(this,arguments);}return/*#__PURE__*/_jsx(\"div\",{className:\"EditVacation Box\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(send),children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Edit Vacation\"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"hidden\"},register(\"vacationId\"))),/*#__PURE__*/_jsx(\"label\",{children:\"Destination: \"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\"},register(\"destination\",VacationModel.destinationValidation))),/*#__PURE__*/_jsx(\"span\",{className:\"Error\",children:(_formState$errors$des=formState.errors.destination)===null||_formState$errors$des===void 0?void 0:_formState$errors$des.message}),/*#__PURE__*/_jsx(\"label\",{children:\"Description: \"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"text\"},register(\"description\",VacationModel.descriptionValidation))),/*#__PURE__*/_jsx(\"span\",{className:\"Error\",children:(_formState$errors$des2=formState.errors.description)===null||_formState$errors$des2===void 0?void 0:_formState$errors$des2.message}),/*#__PURE__*/_jsx(\"label\",{children:\"Start Date: \"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"date\",min:currentDate},register(\"startDate\",VacationModel.startDateValidation))),/*#__PURE__*/_jsx(\"span\",{className:\"Error\",children:(_formState$errors$sta=formState.errors.startDate)===null||_formState$errors$sta===void 0?void 0:_formState$errors$sta.message}),/*#__PURE__*/_jsx(\"label\",{children:\"End Date: \"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"date\",min:currentDate},register(\"endDate\",VacationModel.endDateValidation))),/*#__PURE__*/_jsx(\"span\",{className:\"Error\",children:(_formState$errors$end=formState.errors.endDate)===null||_formState$errors$end===void 0?void 0:_formState$errors$end.message}),/*#__PURE__*/_jsx(\"label\",{children:\"Price: \"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"number\"},register(\"price\",VacationModel.priceValidation))),/*#__PURE__*/_jsx(\"span\",{className:\"Error\",children:(_formState$errors$pri=formState.errors.price)===null||_formState$errors$pri===void 0?void 0:_formState$errors$pri.message}),/*#__PURE__*/_jsx(\"label\",{children:\"Image: \"}),/*#__PURE__*/_jsx(\"input\",_objectSpread({type:\"file\",accept:\"image/*\"},register(\"image\"))),/*#__PURE__*/_jsx(\"button\",{children:\"Update\"})]})});}export default EditVacation;","map":{"version":3,"names":["useEffect","useForm","useNavigate","useParams","VacationModel","VacationsActionType","vacationsStore","authService","notifyService","vacationsService","EditVacation","register","handleSubmit","formState","setValue","navigate","params","currentDate","Date","toISOString","split","isAdmin","error","id","vacationId","getOneVacation","then","vacation","console","log","destination","description","startDate","endDate","price","catch","err","send","image","length","currentVacation","imageName","updateVacation","dispatch","type","EmptyStore","payload","success","destinationValidation","errors","message","descriptionValidation","startDateValidation","endDateValidation","priceValidation"],"sources":["/Users/raniradzewsky/Library/Mobile Documents/com~apple~CloudDocs/Documents/school/John Bryce/John Bryce Projects/Project 3/Vacations Project 5.0/Frontend/src/Components/VacationsArea/EditVacation/EditVacation.tsx"],"sourcesContent":["import { useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport VacationModel from \"../../../Models/VacationModel\";\nimport { VacationsActionType, vacationsStore } from \"../../../Redux/VacationsState\";\nimport authService from \"../../../Services/AuthService\";\nimport notifyService from \"../../../Services/NotifyService\";\nimport vacationsService from \"../../../Services/VacationsService\";\nimport \"./EditVacation.css\";\n\nfunction EditVacation(): JSX.Element {\n\n    const { register, handleSubmit, formState, setValue } = useForm<VacationModel>();\n    const navigate = useNavigate();\n    const params = useParams();\n    const currentDate = new Date().toISOString().split(\"T\")[0];\n\n    \n\n    useEffect(() => {\n\n        if (!authService.isAdmin()) {\n            notifyService.error(\"You must be logged in as admin\");\n            navigate(\"/vacations\");\n            return;\n        }\n\n        const id = +params.vacationId; \n        vacationsService.getOneVacation(id)\n            .then(vacation => {\n                console.log(vacation);\n                \n                setValue(\"vacationId\", vacation.vacationId);\n                setValue(\"destination\", vacation.destination);\n                setValue(\"description\", vacation.description);\n                setValue(\"startDate\", new Date(vacation.startDate).toISOString().split('T')[0]);\n                setValue(\"endDate\", new Date(vacation.endDate).toISOString().split('T')[0]);\n                setValue(\"price\", vacation.price);\n            })\n            .catch(err => notifyService.error(err));\n            \n    }, []);\n\n    async function send(vacation: VacationModel) {\n        try {\n            if (new Date(vacation.startDate) > new Date(vacation.endDate)) {\n                notifyService.error(\"Start date must be before the end date\")\n                return;\n            }\n            if(vacation.image.length<1) {\n                const currentVacation = await vacationsService.getOneVacation(vacation.vacationId);\n                console.log(currentVacation, \"works\");\n                vacation.imageName = currentVacation.imageName;\n            }\n            await vacationsService.updateVacation(vacation);\n            vacationsStore.dispatch({ type: VacationsActionType.EmptyStore, payload: [] });\n            notifyService.success(\"Vacation has been successfully updated\");\n            navigate(\"/vacations\");\n        }\n        catch (err: any) {\n            notifyService.error(err);\n        }\n    }\n\n    return (\n        <div className=\"EditVacation Box\">\n\n            <form onSubmit={handleSubmit(send)}>\n\n                <h2>Edit Vacation</h2>\n\n                <input type=\"hidden\" {...register(\"vacationId\")} />\n\n                <label>Destination: </label>\n                <input type=\"text\" {...register(\"destination\", VacationModel.destinationValidation)} />\n                <span className=\"Error\">{formState.errors.destination?.message}</span>\n\n                <label>Description: </label>\n                <input type=\"text\" {...register(\"description\", VacationModel.descriptionValidation)} />\n                <span className=\"Error\">{formState.errors.description?.message}</span>\n\n                <label>Start Date: </label>\n                <input type=\"date\" min={currentDate} {...register(\"startDate\", VacationModel.startDateValidation)} />\n                <span className=\"Error\">{formState.errors.startDate?.message}</span>\n\n                <label>End Date: </label>\n                <input type=\"date\" min={currentDate} {...register(\"endDate\", VacationModel.endDateValidation)} />\n                <span className=\"Error\">{formState.errors.endDate?.message}</span>\n\n                <label>Price: </label>\n                <input type=\"number\" {...register(\"price\", VacationModel.priceValidation)} />\n                <span className=\"Error\">{formState.errors.price?.message}</span>\n\n                <label>Image: </label>\n                <input type=\"file\" accept=\"image/*\" {...register(\"image\")} />\n\n                <button>Update</button>\n\n            </form>\n\n        </div>\n    );\n}\n\nexport default EditVacation;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}